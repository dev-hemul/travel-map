name: Notify team on PR events

on:
  pull_request:
    types: [opened, reopened, closed]   # –†–µ–∞–≥—É—î–º–æ –Ω–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è, reopen —ñ –∑–∞–∫—Ä–∏—Ç—Ç—è PR

jobs:
  notify:
    runs-on: ubuntu-latest

    steps:
      - name: Notify when PR opened
        if: github.event.action == 'opened' || github.event.action == 'reopened'
        run: |
          MESSAGE="üÜï –ù–æ–≤–∏–π Pull Request –≤—ñ–¥ *${{ github.event.pull_request.user.login }}*

*–ù–∞–∑–≤–∞:* ${{ github.event.pull_request.title }}
*–ì—ñ–ª–∫–∞:* ${{ github.event.pull_request.head.ref }} ‚Üí ${{ github.event.pull_request.base.ref }}
üîó [–î–∏–≤–∏—Ç–∏—Å—å PR](${{ github.event.pull_request.html_url }})"

          curl -s -X POST https://api.telegram.org/bot${{ secrets.TG_BOT_TOKEN }}/sendMessage \
            -d chat_id=${{ secrets.TG_CHAT_ID }} \
            -d parse_mode="Markdown" \
            -d text="$MESSAGE"

      - name: Notify when PR merged
        if: github.event.action == 'closed' && github.event.pull_request.merged == true
        run: |
          MESSAGE="‚úÖ Pull Request *#${{ github.event.pull_request.number }}* –±—É–≤ –∑–ª–∏—Ç–∏–π –≤ –≥—ñ–ª–∫—É *${{ github.event.pull_request.base.ref }}*

–ê–≤—Ç–æ—Ä: ${{ github.event.pull_request.user.login }}
üîó [–î–∏–≤–∏—Ç–∏—Å—å PR](${{ github.event.pull_request.html_url }})

üëâ –ù–µ –∑–∞–±—É–¥—å—Ç–µ –∑—Ä–æ–±–∏—Ç–∏ \`git pull\`!"

          curl -s -X POST https://api.telegram.org/bot${{ secrets.TG_BOT_TOKEN }}/sendMessage \
            -d chat_id=${{ secrets.TG_CHAT_ID }} \
            -d parse_mode="Markdown" \
            -d text="$MESSAGE"

      - name: Notify when PR closed without merge
        if: github.event.action == 'closed' && github.event.pull_request.merged == false
        run: |
          MESSAGE="‚ö†Ô∏è Pull Request *#${{ github.event.pull_request.number }}* –±—É–≤ –∑–∞–∫—Ä–∏—Ç–∏–π –±–µ–∑ merge.

–ê–≤—Ç–æ—Ä: ${{ github.event.pull_request.user.login }}
üîó [–°–º–æ—Ç—Ä–µ—Ç—å PR](${{ github.event.pull_request.html_url }})"

          curl -s -X POST https://api.telegram.org/bot${{ secrets.TG_BOT_TOKEN }}/sendMessage \
            -d chat_id=${{ secrets.TG_CHAT_ID }} \
            -d parse_mode="Markdown" \
            -d text="$MESSAGE"
